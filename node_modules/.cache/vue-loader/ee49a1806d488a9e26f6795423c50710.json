{"remainingRequest":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/src/components/Attendance/CheckinForm/form-submission.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/src/components/Attendance/CheckinForm/form-submission.vue","mtime":1673491775260},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/babel-loader/lib/index.js","mtime":1673491971758},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/index.js","mtime":1673491936504}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBwTWluRGVsYXkgZnJvbSAncC1taW4tZGVsYXknCmltcG9ydCB7IEdyb3Vwd2FyZUFQSSB9IGZyb20gJy4uLy4uLy4uL2xpYi9heGlvcycKaW1wb3J0IHsgZm9ybWF0RGF0ZUxvbmcsIGZvcm1hdFRpbWUgfSBmcm9tICcuLi8uLi8uLi9saWIvZGF0ZScKaW1wb3J0IHsgbW9vZHMgfSBmcm9tICcuLi8uLi9SZWFjdGlvbnMnCgpjb25zdCBTVEFUVVMgPSB7CiAgTE9BRElORzogJ0xPQURJTkcnLAogIFNVQ0NFU1M6ICdTVUNDRVNTJywKICBFUlJPUjogJ0VSUk9SJwp9CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQVBJUG9zdERhdGFMb2FkaW5nRGlhbG9nOiAoKSA9PiBpbXBvcnQoJy4uLy4uL0FQSVBvc3REYXRhTG9hZGluZ0RpYWxvZycpCiAgfSwKICBwcm9wczogewogICAgcGF5bG9hZDogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+ICh7fSkKICAgIH0KICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgU1RBVFVTLAogICAgICBpc0Zvcm1TdWJtaXR0ZWQ6IGZhbHNlLAogICAgICBmb3JtU3VibWlzc2lvblN0YXR1czogbnVsbCwKICAgICAgZm9ybVN1Ym1pc3Npb25FcnJvcjogbnVsbAogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8vIGZvcm1hdCBwYXlsb2FkIGFzIHJlcXVpcmVkCiAgICBmb3JtYXR0ZWRQYXlsb2FkICgpIHsKICAgICAgY29uc3QgeyBkYXRlLCAuLi5yZXN0IH0gPSB0aGlzLnBheWxvYWQKICAgICAgY29uc3QgcGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oe30sIHJlc3QsIHsKICAgICAgICBkYXRlOiBkYXRlIGluc3RhbmNlb2YgRGF0ZSA/IGRhdGUudG9JU09TdHJpbmcoKSA6IG51bGwKICAgICAgfSkKICAgICAgcmV0dXJuIHBheWxvYWQKICAgIH0sCiAgICBtb29kQ29tcG9uZW50ICgpIHsKICAgICAgY29uc3QgeyBtb29kIH0gPSB0aGlzLnBheWxvYWQKICAgICAgY29uc3QgbWF0Y2hlZCA9IG1vb2RzLmZpbmQoKG0pID0+IG0udmFsdWUgPT09IG1vb2QpCiAgICAgIHJldHVybiBtYXRjaGVkID8gbWF0Y2hlZC5jb21wb25lbnQgOiBudWxsCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBmb3JtYXREYXRlTG9uZzogZGF0ZSA9PiBkYXRlID8gZm9ybWF0RGF0ZUxvbmcoZGF0ZSwgJ2VlZWUsIFBQUCcpIDogbnVsbCwKICAgIGZvcm1hdFRpbWU6IHRpbWUgPT4gdGltZSA/IGZvcm1hdFRpbWUodGltZSkgOiBudWxsLAoKICAgIG9uRWRpdERhdGEgKCkgewogICAgICB0aGlzLiRlbWl0KCdjYW5jZWwnKQogICAgfSwKICAgIG9uQ2xvc2UgKCkgewogICAgICBpZiAodGhpcy5pc0Zvcm1TdWJtaXR0ZWQpIHsKICAgICAgICBzd2l0Y2ggKHRoaXMuZm9ybVN1Ym1pc3Npb25TdGF0dXMpIHsKICAgICAgICAgIGNhc2UgU1RBVFVTLlNVQ0NFU1M6IHJldHVybiB0aGlzLiRlbWl0KCdzdWNjZXNzJykKICAgICAgICAgIGNhc2UgU1RBVFVTLkVSUk9SOiByZXR1cm4gdGhpcy4kZW1pdCgnZXJyb3InLCB0aGlzLmZvcm1TdWJtaXNzaW9uRXJyb3IpCiAgICAgICAgICBkZWZhdWx0OiBicmVhawogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRlbWl0KCdjbG9zZScpCiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBvblN1Ym1pdCAoKSB7CiAgICAgIHRoaXMuZm9ybVN1Ym1pc3Npb25TdGF0dXMgPSBTVEFUVVMuTE9BRElORwogICAgICB0aGlzLmZvcm1TdWJtaXNzaW9uRXJyb3IgPSBudWxsCiAgICAgIHRoaXMuaXNGb3JtU3VibWl0dGVkID0gdHJ1ZQogICAgICB0cnkgewogICAgICAgIGNvbnN0IHBvc3QgPSBHcm91cHdhcmVBUEkucG9zdCgnYXR0ZW5kYW5jZS9jaGVja2luJywgdGhpcy5wYXlsb2FkKQogICAgICAgIGF3YWl0IHBNaW5EZWxheShwb3N0LCAxNTAwKQogICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjaGVja2lucy1saXN0L2dldENoZWNraW5TdGF0ZScsIHsgcmVmcmVzaDogdHJ1ZSB9KQogICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjaGVja2lucy1saXN0L2dldENoZWNrb3V0U3RhdGUnLCB7IHJlZnJlc2g6IHRydWUgfSkKICAgICAgICBhd2FpdCB0aGlzLm9uU3VibWl0U3VjY2VzcygpCiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBhd2FpdCB0aGlzLm9uU3VibWl0RXJyb3IoZSkKICAgICAgfQogICAgfSwKICAgIGFzeW5jIG9uU3VibWl0U3VjY2VzcyAoKSB7CiAgICAgIHRoaXMuZm9ybVN1Ym1pc3Npb25TdGF0dXMgPSBTVEFUVVMuU1VDQ0VTUwogICAgfSwKICAgIGFzeW5jIG9uU3VibWl0RXJyb3IgKGVycikgewogICAgICB0aGlzLmZvcm1TdWJtaXNzaW9uU3RhdHVzID0gU1RBVFVTLkVSUk9SCiAgICAgIGlmIChlcnIucmVzcG9uc2UpIHsKICAgICAgICB0aGlzLmZvcm1TdWJtaXNzaW9uRXJyb3IgPSBlcnIucmVzcG9uc2UuZGF0YS5tZXNzYWdlCiAgICAgIH0gZWxzZSBpZiAoZXJyIGluc3RhbmNlb2YgRXJyb3IpIHsKICAgICAgICB0aGlzLmZvcm1TdWJtaXNzaW9uRXJyb3IgPSBlcnIubWVzc2FnZQogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["form-submission.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"form-submission.vue","sourceRoot":"src/components/Attendance/CheckinForm","sourcesContent":["<template>\n  <div class=\"checkin-confirmation\">\n    <template v-if=\"!isFormSubmitted\">\n      <div v-if=\"payload\" class=\"checkin-confirmation__body\">\n        <h3 class=\"text-xl font-bold dark:text-gray-300\">\n          Konfirmasi Checkin\n        </h3>\n        <p class=\"mb-3 text-gray-800 dark:text-gray-400\">\n          Yuk cek lagi data checkin kamu hari ini.\n        </p>\n        <strong class=\"text-green-600 dark:text-gray-300 text-lg\">Hadir ({{ payload.location }})</strong>\n        <br />\n        <label class=\"text-gray-500 dark:text-gray-300\">Tanggal</label>\n        <p class=\"text-gray-800 dark:text-gray-400\">{{ formatDateLong(payload.date) }}</p>\n\n        <label class=\"text-gray-500 dark:text-gray-300\">Jam Hadir</label>\n        <p class=\"text-gray-800 dark:text-gray-400\">{{ formatTime(payload.date) }}</p>\n\n        <label class=\"text-gray-500 dark:text-gray-300\">Mood</label>\n        <i\n          aria-hidden=\"true\"\n          class=\"block w-12 my-2\">\n          <component\n            :is=\"moodComponent\"\n            :animate=\"true\" />\n        </i>\n\n        <label class=\"text-gray-500 dark:text-gray-300\">Catatan</label>\n        <p class=\"text-gray-800 dark:text-gray-400\">{{ payload.note || '-' }}</p>\n      </div>\n      <div class=\"checkin-confirmation__actions\">\n          <button class=\"checkin-confirmation__btn btn-confirm\" @click=\"onSubmit\">\n            Sudah Benar\n          </button>\n          <button class=\"checkin-confirmation__btn btn-cancel\" @click=\"onEditData\">\n            Edit Lagi\n          </button>\n      </div>\n    </template>\n    <template v-else>\n      <div class=\"checkin-confirmation__body\">\n        <APIPostDataLoadingDialog v-if=\"isFormSubmitted\" :state=\"formSubmissionStatus\" @close=\"onClose\">\n          <template #message-error>\n            {{ formSubmissionError }}\n          </template>\n        </APIPostDataLoadingDialog>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\nimport pMinDelay from 'p-min-delay'\nimport { GroupwareAPI } from '../../../lib/axios'\nimport { formatDateLong, formatTime } from '../../../lib/date'\nimport { moods } from '../../Reactions'\n\nconst STATUS = {\n  LOADING: 'LOADING',\n  SUCCESS: 'SUCCESS',\n  ERROR: 'ERROR'\n}\n\nexport default {\n  components: {\n    APIPostDataLoadingDialog: () => import('../../APIPostDataLoadingDialog')\n  },\n  props: {\n    payload: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  data () {\n    return {\n      STATUS,\n      isFormSubmitted: false,\n      formSubmissionStatus: null,\n      formSubmissionError: null\n    }\n  },\n  computed: {\n    // format payload as required\n    formattedPayload () {\n      const { date, ...rest } = this.payload\n      const payload = Object.assign({}, rest, {\n        date: date instanceof Date ? date.toISOString() : null\n      })\n      return payload\n    },\n    moodComponent () {\n      const { mood } = this.payload\n      const matched = moods.find((m) => m.value === mood)\n      return matched ? matched.component : null\n    }\n  },\n  methods: {\n    formatDateLong: date => date ? formatDateLong(date, 'eeee, PPP') : null,\n    formatTime: time => time ? formatTime(time) : null,\n\n    onEditData () {\n      this.$emit('cancel')\n    },\n    onClose () {\n      if (this.isFormSubmitted) {\n        switch (this.formSubmissionStatus) {\n          case STATUS.SUCCESS: return this.$emit('success')\n          case STATUS.ERROR: return this.$emit('error', this.formSubmissionError)\n          default: break\n        }\n      } else {\n        this.$emit('close')\n      }\n    },\n    async onSubmit () {\n      this.formSubmissionStatus = STATUS.LOADING\n      this.formSubmissionError = null\n      this.isFormSubmitted = true\n      try {\n        const post = GroupwareAPI.post('attendance/checkin', this.payload)\n        await pMinDelay(post, 1500)\n        await this.$store.dispatch('checkins-list/getCheckinState', { refresh: true })\n        await this.$store.dispatch('checkins-list/getCheckoutState', { refresh: true })\n        await this.onSubmitSuccess()\n      } catch (e) {\n        await this.onSubmitError(e)\n      }\n    },\n    async onSubmitSuccess () {\n      this.formSubmissionStatus = STATUS.SUCCESS\n    },\n    async onSubmitError (err) {\n      this.formSubmissionStatus = STATUS.ERROR\n      if (err.response) {\n        this.formSubmissionError = err.response.data.message\n      } else if (err instanceof Error) {\n        this.formSubmissionError = err.message\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.checkin-confirmation {\n  @apply flex flex-col overflow-hidden max-h-full;\n\n  &__body {\n    @apply flex-1 p-4 overflow-y-auto;\n\n    > label {\n      @apply font-bold text-sm;\n    }\n\n    > p {\n      @apply mb-2\n      text-base;\n    }\n  }\n\n  &__actions {\n    display: grid;\n    grid-template-columns: repeat(1, 1fr);\n    gap: 1rem;\n    box-shadow: 0 -4px 16px 0 rgba(0,0,0,0.1);\n    @apply relative z-10\n    flex-none\n    mt-4 p-4;\n\n    @screen md {\n      grid-template-columns: repeat(2, 1fr);\n    }\n  }\n\n  &__btn {\n    border-color: currentColor;\n    @apply px-4 py-2 rounded\n    border border-solid;\n\n    &.btn-confirm {\n      @apply bg-blue-600 text-white;\n    }\n\n    &.btn-cancel {\n      @apply bg-white text-blue-600;\n    }\n  }\n}\n\n.submit-status {\n  @apply text-center;\n\n  > img {\n    @apply mb-8 mx-auto;\n  }\n\n  &__text {\n    @apply text-xl font-bold;\n  }\n\n  &__btn-close {\n    @apply w-full mt-8 px-4 py-2 rounded-lg\n    border border-solid border-gray-600\n    bg-gray-100\n    text-gray-600;\n  }\n}\n</style>\n"]}]}