{"remainingRequest":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/src/components/Form/FileSelector.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/src/components/Form/FileSelector.vue","mtime":1673491775263},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/babel-loader/lib/index.js","mtime":1673491971758},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/index.js","mtime":1673491936504}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHByb3BzIH0gZnJvbSAnLi9pbnB1dC1taXhpbicKCmV4cG9ydCBkZWZhdWx0IHsKICBpbmhlcml0QXR0cnM6IGZhbHNlLAogIHByb3BzOiB7CiAgICAuLi5wcm9wcywKICAgIHVybDogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0sCiAgICBmaWxlOiB7CiAgICAgIHR5cGU6IEZpbGUsCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0KICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgbUZpbGU6IG51bGwsCiAgICAgIG1Vcmw6IG51bGwsCiAgICAgIGlzVmFsaWQ6IG51bGwKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBpc1ZhbGlkYXRpb25EaXNhYmxlZCAoKSB7CiAgICAgIGNvbnN0IHsgbVVybCB9ID0gdGhpcwogICAgICBpZiAodHlwZW9mIG1VcmwgIT09ICdzdHJpbmcnIHx8ICFtVXJsLmxlbmd0aCkgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICAgIC8vIGlmIG1Vcmwgc3RhcnRzIHdpdGggdGhlc2Ugc3RyaW5nLCBhc3N1bWUgZmlsZSBlaXRoZXIgaGFzIGFscmVhZHkgYmVlbiB1cGxvYWRlZCBvciBjaGFuZ2VkCiAgICAgIHJldHVybiBbJ2h0dHAnLCAnYmxvYjonXS5zb21lKChzdHIpID0+IG1Vcmwuc3RhcnRzV2l0aChzdHIpKQogICAgfSwKICAgIGZpbGVuYW1lICgpIHsKICAgICAgaWYgKHRoaXMubUZpbGUgaW5zdGFuY2VvZiBGaWxlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubUZpbGUubmFtZQogICAgICB9CiAgICAgIGlmICh0eXBlb2YgdGhpcy51cmwgPT09ICdzdHJpbmcnICYmIHRoaXMudXJsLnN0YXJ0c1dpdGgoJ2h0dHAnKSkgewogICAgICAgIGNvbnN0IGkgPSB0aGlzLnVybC5sYXN0SW5kZXhPZignZG9jdW1lbnQvJykKICAgICAgICByZXR1cm4gdGhpcy51cmwuc3Vic3RyaW5nKGkpCiAgICAgIH0KICAgICAgcmV0dXJuIG51bGwKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICB1cmw6IHsKICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICBoYW5kbGVyICh2KSB7CiAgICAgICAgdGhpcy5tVXJsID0gdgogICAgICB9CiAgICB9LAogICAgZmlsZTogewogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICAgIGhhbmRsZXIgKHYpIHsKICAgICAgICB0aGlzLm1GaWxlID0gdgogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBvblByZXZpZXcgKCkgewogICAgICBpZiAodGhpcy5pc1ZhbGlkKSB7CiAgICAgICAgdGhpcy4kZW1pdCgncHJldmlldycpCiAgICAgIH0gZWxzZSBpZiAodGhpcy5tVXJsKSB7CiAgICAgICAgd2luZG93Lm9wZW4odGhpcy5tVXJsLCAnX2JsYW5rJykKICAgICAgfQogICAgfSwKICAgIHJlc2V0SW5wdXRFbGVtZW50ICgpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuaW5wdXQpIHsKICAgICAgICB0aGlzLiRyZWZzLnZhbGlkYXRvci5yZXNldCgpCiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC50eXBlID0gJycKICAgICAgICB0aGlzLiRyZWZzLmlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICcnKQogICAgICAgIHJldHVybiB0aGlzLiRuZXh0VGljaygpCiAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQudHlwZSA9ICdmaWxlJwogICAgICAgICAgICB0aGlzLiRyZWZzLmlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICdmaWxlJykKICAgICAgICAgIH0pCiAgICAgIH0KICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpCiAgICB9LAogICAgb25DaG9vc2VGaWxlICgpIHsKICAgICAgdGhpcy5pc1ZhbGlkID0gbnVsbAogICAgICB0aGlzLm1GaWxlID0gbnVsbAogICAgICB0aGlzLm1VcmwgPSBudWxsCiAgICAgIHRoaXMucmVzZXRJbnB1dEVsZW1lbnQoKQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuY2xpY2soKQogICAgICAgIH0pCiAgICB9LAogICAgb25SZW1vdmVGaWxlICgpIHsKICAgICAgdGhpcy5yZXNldElucHV0RWxlbWVudCgpCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy5pc1ZhbGlkID0gbnVsbAogICAgICAgICAgdGhpcy5tRmlsZSA9IG51bGwKICAgICAgICAgIHRoaXMubVVybCA9IG51bGwKICAgICAgICAgIHRoaXMuZW1pdENoYW5nZShudWxsLCBudWxsKQogICAgICAgICAgcmV0dXJuIHRoaXMuJG5leHRUaWNrKCkKICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuJHJlZnMudmFsaWRhdG9yLnZhbGlkYXRlKCkKICAgICAgICB9KQogICAgfSwKICAgIGFzeW5jIG9uQ2hhbmdlIChlKSB7CiAgICAgIGlmIChlLnRhcmdldC5maWxlcykgewogICAgICAgIGNvbnN0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXSB8fCBudWxsCiAgICAgICAgYXdhaXQgdGhpcy4kcmVmcy52YWxpZGF0b3Iuc3luY1ZhbHVlKGZpbGUpCiAgICAgICAgY29uc3QgeyB2YWxpZCB9ID0gYXdhaXQgdGhpcy4kcmVmcy52YWxpZGF0b3IudmFsaWRhdGUoKQogICAgICAgIHRoaXMuaXNWYWxpZCA9IHZhbGlkCiAgICAgICAgdGhpcy5tRmlsZSA9IGZpbGUKICAgICAgICB0aGlzLm1VcmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTCh0aGlzLm1GaWxlKQogICAgICAgIGlmICh0aGlzLmlzVmFsaWQpIHsKICAgICAgICAgIHRoaXMuZW1pdENoYW5nZSh0aGlzLm1VcmwsIHRoaXMubUZpbGUpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZW1pdENoYW5nZShudWxsLCBudWxsKQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGVtaXRDaGFuZ2UgKHVybCwgZmlsZSkgewogICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCB1cmwsIGZpbGUpCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["FileSelector.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FileSelector.vue","sourceRoot":"src/components/Form","sourcesContent":["<template>\n  <ValidationProvider\n    :rules=\"rules\"\n    :custom-messages=\"customMessages\"\n    :disabled=\"isValidationDisabled\"\n    #default=\"{failed, errors}\"\n    tag=\"div\"\n    ref=\"validator\"\n  >\n    <div :class=\"{'form-input__file mb-2': true, 'is-invalid': failed}\">\n      <a\n        href=\"javascript:void(0)\"\n        target=\"_blank\"\n        @click.prevent=\"onPreview\"\n      >\n        <span>\n          {{ filename || $attrs.placeholder }}\n        </span>\n      </a>\n      <button\n        v-if=\"!disabled\"\n        :disabled=\"disabled\"\n        @click=\"onChooseFile\"\n      >\n        <slot name=\"choose-file-button-text\">\n          Pilih\n        </slot>\n      </button>\n    </div>\n    <input\n      v-show=\"false\"\n      ref=\"input\"\n      :name=\"name\"\n      type=\"file\"\n      :accept=\"$attrs.accept\"\n      :multiple=\"false\"\n      v-bind=\"$attrs\"\n      @change=\"onChange($event)\"\n    >\n    <p\n      v-if=\"errors.length\"\n      class=\"form-input__error-hint\"\n    >\n      <slot name=\"error\">\n        {{errors[0]}}\n      </slot>\n    </p>\n  </ValidationProvider>\n</template>\n\n<script>\nimport { props } from './input-mixin'\n\nexport default {\n  inheritAttrs: false,\n  props: {\n    ...props,\n    url: {\n      type: String,\n      default: null\n    },\n    file: {\n      type: File,\n      default: null\n    }\n  },\n  data () {\n    return {\n      mFile: null,\n      mUrl: null,\n      isValid: null\n    }\n  },\n  computed: {\n    isValidationDisabled () {\n      const { mUrl } = this\n      if (typeof mUrl !== 'string' || !mUrl.length) {\n        return false\n      }\n      // if mUrl starts with these string, assume file either has already been uploaded or changed\n      return ['http', 'blob:'].some((str) => mUrl.startsWith(str))\n    },\n    filename () {\n      if (this.mFile instanceof File) {\n        return this.mFile.name\n      }\n      if (typeof this.url === 'string' && this.url.startsWith('http')) {\n        const i = this.url.lastIndexOf('document/')\n        return this.url.substring(i)\n      }\n      return null\n    }\n  },\n  watch: {\n    url: {\n      immediate: true,\n      handler (v) {\n        this.mUrl = v\n      }\n    },\n    file: {\n      immediate: true,\n      handler (v) {\n        this.mFile = v\n      }\n    }\n  },\n  methods: {\n    onPreview () {\n      if (this.isValid) {\n        this.$emit('preview')\n      } else if (this.mUrl) {\n        window.open(this.mUrl, '_blank')\n      }\n    },\n    resetInputElement () {\n      if (this.$refs.input) {\n        this.$refs.validator.reset()\n        this.$refs.input.type = ''\n        this.$refs.input.setAttribute('type', '')\n        return this.$nextTick()\n          .then(() => {\n            this.$refs.input.type = 'file'\n            this.$refs.input.setAttribute('type', 'file')\n          })\n      }\n      return Promise.resolve()\n    },\n    onChooseFile () {\n      this.isValid = null\n      this.mFile = null\n      this.mUrl = null\n      this.resetInputElement()\n        .then(() => {\n          this.$refs.input.click()\n        })\n    },\n    onRemoveFile () {\n      this.resetInputElement()\n        .then(() => {\n          this.isValid = null\n          this.mFile = null\n          this.mUrl = null\n          this.emitChange(null, null)\n          return this.$nextTick()\n        }).then(() => {\n          this.$refs.validator.validate()\n        })\n    },\n    async onChange (e) {\n      if (e.target.files) {\n        const file = e.target.files[0] || null\n        await this.$refs.validator.syncValue(file)\n        const { valid } = await this.$refs.validator.validate()\n        this.isValid = valid\n        this.mFile = file\n        this.mUrl = window.URL.createObjectURL(this.mFile)\n        if (this.isValid) {\n          this.emitChange(this.mUrl, this.mFile)\n        } else {\n          this.emitChange(null, null)\n        }\n      }\n    },\n    emitChange (url, file) {\n      this.$emit('change', url, file)\n    }\n  }\n}\n</script>\n"]}]}