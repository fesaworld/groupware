{"remainingRequest":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/layouts/default.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/layouts/default.vue","mtime":1673491775268},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/babel-loader/lib/index.js","mtime":1673491971758},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/vue-loader/lib/index.js","mtime":1673491936504}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JwppbXBvcnQgTmF2YmFyIGZyb20gJ0AvY29tcG9uZW50cy9OYXZiYXInCmltcG9ydCB7IG1lc3NhZ2luZyB9IGZyb20gJ0AvbGliL2ZpcmViYXNlJwppbXBvcnQgeyBnZXREZXZpY2VUb2tlbkJ5VXNlcklkLCByZXRyaWV2ZVRva2VuLCB1cGRhdGVUb2tlbiwgbGlzdGVuVG9SZWZyZXNoVG9rZW5FdmVudCB9IGZyb20gJy4uL2xpYi9mY20tbm90aWZpY2F0aW9uJwppbXBvcnQgRGlnaXRlYW1FbWJsZW0gZnJvbSAnLi4vY29tcG9uZW50cy9EaWdpdGVhbUVtYmxlbS52dWUnCmltcG9ydCBUaGVtZVN3aXRjaGVyIGZyb20gJy4uL2NvbXBvbmVudHMvVGhlbWVTd2l0Y2hlci52dWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgTmF2YmFyLAogICAgRGlnaXRlYW1FbWJsZW0sCiAgICBUaGVtZVN3aXRjaGVyCiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoeyB0aGVtZTogJ3RoZW1lL2dldFRoZW1lJyB9KQogIH0sCgogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgc2hvd1BvcHVwTm90aWZpY2F0aW9uOiBmYWxzZQogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgICckc3RvcmUuc3RhdGUuYXV0aC51c2VyJzogewogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICAgIGhhbmRsZXIgKHYpIHsKICAgICAgICBpZiAodikgewogICAgICAgICAgdGhpcy5jaGVja1Blcm1pc3Npb24oKQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRoZW1lIChuZXdUaGVtZSwgb2xkVGhlbWUpIHsKICAgICAgbmV3VGhlbWUgPT09ICdsaWdodCcKICAgICAgICA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5jbGFzc0xpc3QucmVtb3ZlKCdkYXJrLW1vZGUnKQogICAgICAgIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpLmNsYXNzTGlzdC5hZGQoJ2RhcmstbW9kZScpCiAgICB9CiAgfSwKICBiZWZvcmVNb3VudCAoKSB7CiAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndGhlbWUvaW5pdFRoZW1lJykKICB9LAogIG1vdW50ZWQgKCkgewogICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2hvbWUtYmFubmVycy9mZXRjaEl0ZW1zJykKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdob21lLWFydGljbGVzL2ZldGNoSXRlbXMnKQogICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21lc3NhZ2VzLWxpc3QvZmV0Y2hJdGVtcycpCiAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZXZlbnRzLWxpc3QvZmV0Y2hJdGVtcycpCiAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndGhhbmt5b3UtbGlzdC9mZXRjaEl0ZW1zJykKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd0ZWFtcy1saXN0L2ZldGNoSXRlbXMnKQogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGNoZWNrUGVybWlzc2lvbiAoKSB7CiAgICAgIGlmICghbWVzc2FnaW5nKSByZXR1cm4KICAgICAgaWYgKCF0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnVzZXIpIHJldHVybgoKICAgICAgY29uc3QgcGVybWlzc2lvbiA9IGF3YWl0IE5vdGlmaWNhdGlvbi5wZXJtaXNzaW9uCgogICAgICBpZiAocGVybWlzc2lvbiA9PT0gJ2RlZmF1bHQnKSB7CiAgICAgICAgdGhpcy5zaG93UG9wdXBOb3RpZmljYXRpb24gPSB0cnVlCiAgICAgIH0KCiAgICAgIGlmIChwZXJtaXNzaW9uID09PSAnZ3JhbnRlZCcpIHsKICAgICAgICBjb25zdCBleGlzdGluZ1Rva2VuID0gYXdhaXQgZ2V0RGV2aWNlVG9rZW5CeVVzZXJJZCh0aGlzLiRzdG9yZS5zdGF0ZS5hdXRoLnVzZXIuaWQpCiAgICAgICAgaWYgKCFleGlzdGluZ1Rva2VuKSB7CiAgICAgICAgICBhd2FpdCByZXRyaWV2ZVRva2VuKCkKICAgICAgICB9CiAgICAgICAgbGlzdGVuVG9SZWZyZXNoVG9rZW5FdmVudCgpCiAgICAgIH0KICAgICAgaWYgKHBlcm1pc3Npb24gPT09ICdkZW5pZWQnKSB7CiAgICAgICAgLy8KICAgICAgfQogICAgfSwKCiAgICBhc3luYyBhbGxvd05vdGlmaWNhdGlvbiAoKSB7CiAgICAgIGlmICghbWVzc2FnaW5nKSByZXR1cm4KCiAgICAgIC8vIFJlcXVlc3QgUGVybWlzc2lvbiBvZiBOb3RpZmljYXRpb25zCiAgICAgIGNvbnN0IHBlcm1pc3Npb24gPSBhd2FpdCBOb3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24oKQoKICAgICAgaWYgKHBlcm1pc3Npb24gPT09ICdncmFudGVkJykgewogICAgICAgIGNvbnN0IGV4aXN0aW5nVG9rZW4gPSBhd2FpdCBnZXREZXZpY2VUb2tlbkJ5VXNlcklkKHRoaXMuJHN0b3JlLnN0YXRlLmF1dGgudXNlci5pZCkKICAgICAgICBpZiAoIWV4aXN0aW5nVG9rZW4pIHsKICAgICAgICAgIGF3YWl0IHJldHJpZXZlVG9rZW4oKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhd2FpdCB1cGRhdGVUb2tlbigpCiAgICAgICAgfQogICAgICAgIGxpc3RlblRvUmVmcmVzaFRva2VuRXZlbnQoKQogICAgICB9CgogICAgICB0aGlzLnNob3dQb3B1cE5vdGlmaWNhdGlvbiA9IGZhbHNlCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["default.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"default.vue","sourceRoot":"src/layouts","sourcesContent":["<template>\n  <div class=\"select-none no-pull-refresh dark:bg-gray-800\">\n    <transition name=\"translate-to-bottom\">\n      <div\n        v-if=\"showPopupNotification\"\n        class=\"h-16 overflow-hidden flex items-center bg-brand-yellow-darkest\">\n        <div class=\"container mx-auto px-6\">\n          <div class=\"text-sm w-full\">\n            Izinkan notifikasi mengirim pesan\n            <button @click=\"allowNotification\" class=\"ml-2 bg-brand-blue text-white font-bold py-1 px-4 rounded focus:outline-none focus:shadow-outline\" type=\"button\">\n              Allow\n            </button>\n          </div>\n        </div>\n      </div>\n    </transition>\n\n    <div class=\"bg-white dark:bg-gray-900 dark:text-white\">\n      <div class=\"container mx-auto app-grid-layout grid grid-cols-3\">\n        <div class=\"app-grid-layout__first-column col-span-2\">\n          <DigiteamEmblem class=\"p-6\" />\n        </div>\n        <div class=\"app-grid-layout__second-column\">\n          <!-- intentionally blank -->\n          <ThemeSwitcher\n            :theme=\"theme\"\n            class=\"py-10 text-right\"\n          />\n        </div>\n      </div>\n    </div>\n    <div class=\"app-content\">\n      <slot>\n        <router-view />\n      </slot>\n    </div>\n    <navbar />\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport Navbar from '@/components/Navbar'\nimport { messaging } from '@/lib/firebase'\nimport { getDeviceTokenByUserId, retrieveToken, updateToken, listenToRefreshTokenEvent } from '../lib/fcm-notification'\nimport DigiteamEmblem from '../components/DigiteamEmblem.vue'\nimport ThemeSwitcher from '../components/ThemeSwitcher.vue'\n\nexport default {\n  components: {\n    Navbar,\n    DigiteamEmblem,\n    ThemeSwitcher\n  },\n\n  computed: {\n    ...mapGetters({ theme: 'theme/getTheme' })\n  },\n\n  data () {\n    return {\n      showPopupNotification: false\n    }\n  },\n  watch: {\n    '$store.state.auth.user': {\n      immediate: true,\n      handler (v) {\n        if (v) {\n          this.checkPermission()\n        }\n      }\n    },\n    theme (newTheme, oldTheme) {\n      newTheme === 'light'\n        ? document.querySelector('html').classList.remove('dark-mode')\n        : document.querySelector('html').classList.add('dark-mode')\n    }\n  },\n  beforeMount () {\n    this.$store.dispatch('theme/initTheme')\n  },\n  mounted () {\n    this.$store.dispatch('home-banners/fetchItems')\n    this.$store.dispatch('home-articles/fetchItems')\n    this.$store.dispatch('messages-list/fetchItems')\n    this.$store.dispatch('events-list/fetchItems')\n    this.$store.dispatch('thankyou-list/fetchItems')\n    this.$store.dispatch('teams-list/fetchItems')\n  },\n\n  methods: {\n    async checkPermission () {\n      if (!messaging) return\n      if (!this.$store.state.auth.user) return\n\n      const permission = await Notification.permission\n\n      if (permission === 'default') {\n        this.showPopupNotification = true\n      }\n\n      if (permission === 'granted') {\n        const existingToken = await getDeviceTokenByUserId(this.$store.state.auth.user.id)\n        if (!existingToken) {\n          await retrieveToken()\n        }\n        listenToRefreshTokenEvent()\n      }\n      if (permission === 'denied') {\n        //\n      }\n    },\n\n    async allowNotification () {\n      if (!messaging) return\n\n      // Request Permission of Notifications\n      const permission = await Notification.requestPermission()\n\n      if (permission === 'granted') {\n        const existingToken = await getDeviceTokenByUserId(this.$store.state.auth.user.id)\n        if (!existingToken) {\n          await retrieveToken()\n        } else {\n          await updateToken()\n        }\n        listenToRefreshTokenEvent()\n      }\n\n      this.showPopupNotification = false\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.translate-to-bottom {\n  &-enter-active,\n  &-leave-active {\n    transition-property: height;\n    transition-duration: 0.3s;\n    transition-timing-function: ease-out;\n    transition-delay: 1s;\n  }\n\n  &-enter,\n  &-leave-to {\n    height: 0px;\n  }\n}\n.app-content {\n  min-height: calc(100vh - 10rem);\n  @apply mt-4 mb-12;\n}\n</style>\n"]}]}