{"remainingRequest":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/src/layouts/default.vue?vue&type=style&index=0&id=39336072&lang=scss&scoped=true&","dependencies":[{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/src/layouts/default.vue","mtime":1673491775268},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/css-loader/dist/cjs.js","mtime":1673491970692},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1673491936529},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/postcss-loader/src/index.js","mtime":1673491966590},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/sass-loader/dist/cjs.js","mtime":1673491959555},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/index.js","mtime":1673491936504}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoudHJhbnNsYXRlLXRvLWJvdHRvbSB7CiAgJi1lbnRlci1hY3RpdmUsCiAgJi1sZWF2ZS1hY3RpdmUgewogICAgdHJhbnNpdGlvbi1wcm9wZXJ0eTogaGVpZ2h0OwogICAgdHJhbnNpdGlvbi1kdXJhdGlvbjogMC4zczsKICAgIHRyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uOiBlYXNlLW91dDsKICAgIHRyYW5zaXRpb24tZGVsYXk6IDFzOwogIH0KCiAgJi1lbnRlciwKICAmLWxlYXZlLXRvIHsKICAgIGhlaWdodDogMHB4OwogIH0KfQouYXBwLWNvbnRlbnQgewogIG1pbi1oZWlnaHQ6IGNhbGMoMTAwdmggLSAxMHJlbSk7CiAgQGFwcGx5IG10LTQgbWItMTI7Cn0K"},{"version":3,"sources":["default.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"default.vue","sourceRoot":"src/layouts","sourcesContent":["<template>\n  <div class=\"select-none no-pull-refresh dark:bg-gray-800\">\n    <transition name=\"translate-to-bottom\">\n      <div\n        v-if=\"showPopupNotification\"\n        class=\"h-16 overflow-hidden flex items-center bg-brand-yellow-darkest\">\n        <div class=\"container mx-auto px-6\">\n          <div class=\"text-sm w-full\">\n            Izinkan notifikasi mengirim pesan\n            <button @click=\"allowNotification\" class=\"ml-2 bg-brand-blue text-white font-bold py-1 px-4 rounded focus:outline-none focus:shadow-outline\" type=\"button\">\n              Allow\n            </button>\n          </div>\n        </div>\n      </div>\n    </transition>\n\n    <div class=\"bg-white dark:bg-gray-900 dark:text-white\">\n      <div class=\"container mx-auto app-grid-layout grid grid-cols-3\">\n        <div class=\"app-grid-layout__first-column col-span-2\">\n          <DigiteamEmblem class=\"p-6\" />\n        </div>\n        <div class=\"app-grid-layout__second-column\">\n          <!-- intentionally blank -->\n          <ThemeSwitcher\n            :theme=\"theme\"\n            class=\"py-10 text-right\"\n          />\n        </div>\n      </div>\n    </div>\n    <div class=\"app-content\">\n      <slot>\n        <router-view />\n      </slot>\n    </div>\n    <navbar />\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport Navbar from '@/components/Navbar'\nimport { messaging } from '@/lib/firebase'\nimport { getDeviceTokenByUserId, retrieveToken, updateToken, listenToRefreshTokenEvent } from '../lib/fcm-notification'\nimport DigiteamEmblem from '../components/DigiteamEmblem.vue'\nimport ThemeSwitcher from '../components/ThemeSwitcher.vue'\n\nexport default {\n  components: {\n    Navbar,\n    DigiteamEmblem,\n    ThemeSwitcher\n  },\n\n  computed: {\n    ...mapGetters({ theme: 'theme/getTheme' })\n  },\n\n  data () {\n    return {\n      showPopupNotification: false\n    }\n  },\n  watch: {\n    '$store.state.auth.user': {\n      immediate: true,\n      handler (v) {\n        if (v) {\n          this.checkPermission()\n        }\n      }\n    },\n    theme (newTheme, oldTheme) {\n      newTheme === 'light'\n        ? document.querySelector('html').classList.remove('dark-mode')\n        : document.querySelector('html').classList.add('dark-mode')\n    }\n  },\n  beforeMount () {\n    this.$store.dispatch('theme/initTheme')\n  },\n  mounted () {\n    this.$store.dispatch('home-banners/fetchItems')\n    this.$store.dispatch('home-articles/fetchItems')\n    this.$store.dispatch('messages-list/fetchItems')\n    this.$store.dispatch('events-list/fetchItems')\n    this.$store.dispatch('thankyou-list/fetchItems')\n    this.$store.dispatch('teams-list/fetchItems')\n  },\n\n  methods: {\n    async checkPermission () {\n      if (!messaging) return\n      if (!this.$store.state.auth.user) return\n\n      const permission = await Notification.permission\n\n      if (permission === 'default') {\n        this.showPopupNotification = true\n      }\n\n      if (permission === 'granted') {\n        const existingToken = await getDeviceTokenByUserId(this.$store.state.auth.user.id)\n        if (!existingToken) {\n          await retrieveToken()\n        }\n        listenToRefreshTokenEvent()\n      }\n      if (permission === 'denied') {\n        //\n      }\n    },\n\n    async allowNotification () {\n      if (!messaging) return\n\n      // Request Permission of Notifications\n      const permission = await Notification.requestPermission()\n\n      if (permission === 'granted') {\n        const existingToken = await getDeviceTokenByUserId(this.$store.state.auth.user.id)\n        if (!existingToken) {\n          await retrieveToken()\n        } else {\n          await updateToken()\n        }\n        listenToRefreshTokenEvent()\n      }\n\n      this.showPopupNotification = false\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.translate-to-bottom {\n  &-enter-active,\n  &-leave-active {\n    transition-property: height;\n    transition-duration: 0.3s;\n    transition-timing-function: ease-out;\n    transition-delay: 1s;\n  }\n\n  &-enter,\n  &-leave-to {\n    height: 0px;\n  }\n}\n.app-content {\n  min-height: calc(100vh - 10rem);\n  @apply mt-4 mb-12;\n}\n</style>\n"]}]}