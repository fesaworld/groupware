{"remainingRequest":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/components/Form/DocumentFileInput.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/components/Form/DocumentFileInput.vue","mtime":1673491775262},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/babel-loader/lib/index.js","mtime":1673491971758},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/vue-loader/lib/index.js","mtime":1673491936504}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHNhdmVBcyB9IGZyb20gJ2ZpbGUtc2F2ZXInCmltcG9ydCB7IHByb3BzLCBjb21wb25lbnRzIH0gZnJvbSAnLi9pbnB1dC1taXhpbicKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICAuLi5jb21wb25lbnRzLAogICAgRmlsZVNlbGVjdG9yOiAoKSA9PiBpbXBvcnQoJy4vRmlsZVNlbGVjdG9yJykKICB9LAogIG1vZGVsOiB7CiAgICBwcm9wOiAndmFsdWUnLAogICAgZXZlbnQ6ICdpbnB1dCcKICB9LAogIHByb3BzOiB7CiAgICAuLi5wcm9wcywKICAgIHBhdGg6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiBudWxsCiAgICB9LAogICAgdXJsOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogbnVsbAogICAgfQogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBtRmlsZTogbnVsbCwKICAgICAgbVVybDogbnVsbAogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzRmlsZUZyb21TdG9yYWdlICgpIHsKICAgICAgcmV0dXJuIHR5cGVvZiB0aGlzLmZ1bGxQYXRoID09PSAnc3RyaW5nJyAmJiB0aGlzLmZ1bGxQYXRoLnN0YXJ0c1dpdGgoJ2h0dHAnKQogICAgfSwKICAgIGlzU2VsZWN0ZWRGaWxlQ2hhbmdlZCAoKSB7CiAgICAgIHJldHVybiB0aGlzLm1VcmwgJiYgdGhpcy5tVXJsICE9PSB0aGlzLnVybAogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIHVybDogewogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICAgIGhhbmRsZXIgKHYpIHsKICAgICAgICB0aGlzLm1VcmwgPSB2CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGdldERvY3VtZW50VGFza0ZpbGUgKHBhdGgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdsb2dib29rLWRvY3VtZW50cy9nZXREb2N1bWVudCcsIHsgcGF0aCB9KQogICAgfSwKICAgIG9uU2VsZWN0ZWRGaWxlQ2hhbmdlICh1cmwsIGZpbGUpIHsKICAgICAgdGhpcy5tVXJsID0gdXJsCiAgICAgIHRoaXMubUZpbGUgPSBmaWxlCiAgICB9LAogICAgYXN5bmMgb25TYXZlRG9jdW1lbnQgKCkgewogICAgICB0cnkgewogICAgICAgIGlmICh0aGlzLm1GaWxlIGluc3RhbmNlb2YgRmlsZSkgewogICAgICAgICAgc2F2ZUFzKHRoaXMubUZpbGUsIGAke3RoaXMubUZpbGUubmFtZX1gKQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMudXJsID09PSAnc3RyaW5nJyAmJiB0aGlzLnVybC5zdGFydHNXaXRoKCdodHRwJykpIHsKICAgICAgICAgIHRoaXMuJHN3YWwuZmlyZSh7CiAgICAgICAgICAgIHRpdGxlOiAnTWVuZ2FtYmlsIGRhdGEuLi4nLAogICAgICAgICAgICBvbkJlZm9yZU9wZW46ICgpID0+IHRoaXMuJHN3YWwuc2hvd0xvYWRpbmcoKQogICAgICAgICAgfSkKICAgICAgICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLiRwcm9taXNlTWluRGVsYXkodGhpcy5nZXREb2N1bWVudFRhc2tGaWxlKHRoaXMucGF0aCksIDEwMDApCiAgICAgICAgICB0aGlzLiRzd2FsLmNsb3NlKCkKICAgICAgICAgIHNhdmVBcyhmaWxlLCBmaWxlLm5hbWUpCiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdGhpcy4kc3dhbC5maXJlKHsKICAgICAgICAgIGljb246ICdlcnJvcicsCiAgICAgICAgICB0ZXh0OiAnVGVyamFkaSBrZXNhbGFoYW4gZGFsYW0gcGVtYmFjYWFuIGRva3VtZW4nLAogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdUdXR1cCcKICAgICAgICB9KQogICAgICB9CiAgICB9LAogICAgZ2V0U2VsZWN0ZWRGaWxlICgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNTZWxlY3RlZEZpbGVDaGFuZ2VkID8gdGhpcy5tRmlsZSA6IG51bGwKICAgIH0KICB9Cn0K"},{"version":3,"sources":["DocumentFileInput.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DocumentFileInput.vue","sourceRoot":"src/components/Form","sourcesContent":["<template>\n  <div>\n    <FormInputHeader\n      :label-for=\"name\"\n      :title=\"title\"\n      :subtitle=\"subtitle\"\n      :required=\"required\"\n    >\n      <template #title>\n        <slot name=\"title\"></slot>\n      </template>\n      <template #subtitle>\n        <slot name=\"subtitle\"></slot>\n      </template>\n    </FormInputHeader>\n    <FileSelector\n      :file=\"mFile\"\n      :url=\"mUrl\"\n      v-bind=\"$props\"\n      @preview=\"onSaveDocument\"\n      @change=\"onSelectedFileChange\"\n    />\n  </div>\n</template>\n\n<script>\nimport { saveAs } from 'file-saver'\nimport { props, components } from './input-mixin'\n\nexport default {\n  components: {\n    ...components,\n    FileSelector: () => import('./FileSelector')\n  },\n  model: {\n    prop: 'value',\n    event: 'input'\n  },\n  props: {\n    ...props,\n    path: {\n      type: String,\n      default: null\n    },\n    url: {\n      type: String,\n      default: null\n    }\n  },\n  data () {\n    return {\n      mFile: null,\n      mUrl: null\n    }\n  },\n  computed: {\n    isFileFromStorage () {\n      return typeof this.fullPath === 'string' && this.fullPath.startsWith('http')\n    },\n    isSelectedFileChanged () {\n      return this.mUrl && this.mUrl !== this.url\n    }\n  },\n  watch: {\n    url: {\n      immediate: true,\n      handler (v) {\n        this.mUrl = v\n      }\n    }\n  },\n  methods: {\n    getDocumentTaskFile (path) {\n      return this.$store.dispatch('logbook-documents/getDocument', { path })\n    },\n    onSelectedFileChange (url, file) {\n      this.mUrl = url\n      this.mFile = file\n    },\n    async onSaveDocument () {\n      try {\n        if (this.mFile instanceof File) {\n          saveAs(this.mFile, `${this.mFile.name}`)\n        } else if (typeof this.url === 'string' && this.url.startsWith('http')) {\n          this.$swal.fire({\n            title: 'Mengambil data...',\n            onBeforeOpen: () => this.$swal.showLoading()\n          })\n          const file = await this.$promiseMinDelay(this.getDocumentTaskFile(this.path), 1000)\n          this.$swal.close()\n          saveAs(file, file.name)\n        }\n      } catch (e) {\n        this.$swal.fire({\n          icon: 'error',\n          text: 'Terjadi kesalahan dalam pembacaan dokumen',\n          confirmButtonText: 'Tutup'\n        })\n      }\n    },\n    getSelectedFile () {\n      return this.isSelectedFileChanged ? this.mFile : null\n    }\n  }\n}\n</script>\n"]}]}