{"remainingRequest":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/src/components/Dashboard/LogbookHeatmaps/MonthlyHeatmap.vue?vue&type=style&index=0&id=a07ee5f6&lang=scss&scoped=true&","dependencies":[{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/src/components/Dashboard/LogbookHeatmaps/MonthlyHeatmap.vue","mtime":1673491775261},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/css-loader/dist/cjs.js","mtime":1673491970692},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1673491936529},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/postcss-loader/src/index.js","mtime":1673491966590},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/sass-loader/dist/cjs.js","mtime":1673491959555},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/node_modules/vue-loader/lib/index.js","mtime":1673491936504}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQGtleWZyYW1lcyByb3RhdGluZ1JlY3QgewogIGZyb20gewogICAgb3BhY2l0eTogMDsKICB9CiAgdG8gewogICAgb3BhY2l0eTogMTsKICB9Cn0KCi5tb250aGx5LWhlYXRtYXAgewogIG1heC13aWR0aDogMjAwcHg7CiAgQGFwcGx5IGlubGluZS1mbGV4IGZsZXgtY29sIGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdHJldGNoOwoKICAmX19ibG9ja3MgewogICAgZGlzcGxheTogaW5saW5lOwogICAgQGFwcGx5IHctZnVsbDsKICB9CgogICZfX2Jsb2NrIHsKICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDsKICAgIEBhcHBseSBib3JkZXItbm9uZSBiZy10cmFuc3BhcmVudDsKCiAgICAmX19yZWN0IHsKICAgICAgdHJhbnNmb3JtLW9yaWdpbjogY2VudGVyOwogICAgICB0cmFuc2Zvcm0tYm94OiBmaWxsLWJveDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICBAYXBwbHkgYm9yZGVyLW5vbmUgc3Ryb2tlLTA7CgogICAgICAmOmhvdmVyIHsKICAgICAgICBzdHJva2U6IHJnYigwLCAwLCAwLCAwLjIpOwogICAgICAgIHN0cm9rZS13aWR0aDogNjsKICAgICAgfQoKICAgICAgJi5pcy1sb2FkaW5nIHsKICAgICAgICBhbmltYXRpb246IHJvdGF0aW5nUmVjdCAxcyBpbmZpbml0ZSBhbHRlcm5hdGUgZWFzZS1vdXQ7CiAgICAgIH0KICAgIH0KICB9CgogICZfX21vbnRoLW5hbWUgewogICAgQGFwcGx5IGJsb2NrIG1iLTIKICAgIHRleHQtbGVmdCB0ZXh0LXNtCiAgICB0ZXh0LWdyZWVuLTYwMCBmb250LWJvbGQ7CiAgfQp9Cg=="},{"version":3,"sources":["MonthlyHeatmap.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"MonthlyHeatmap.vue","sourceRoot":"src/components/Dashboard/LogbookHeatmaps","sourcesContent":["<template>\n  <div class=\"monthly-heatmap\">\n    <span\n      class=\"monthly-heatmap__month-name\">\n      {{ monthName }}\n    </span>\n    <svg\n      :viewBox=\"viewBoxRectSize\"\n      class=\"monthly-heatmap__blocks\"\n      :key=\"`${year}/${month}`\">\n      <g v-for=\"dayIndex in 7\"\n        :key=\"`day:${dayIndex}`\"\n        class=\"monthly-heatmap__block\"\n        fill=\"transparent\"\n      >\n        <rect\n          :width=\"rectSize\"\n          :height=\"rectSize\"\n          :x=\"getRectX(dayIndex - 1)\"\n          :y=\"getRectY(dayIndex - 1)\"\n        />\n        <text\n          :x=\"getDayNameTextX(dayIndex - 1)\"\n          :y=\"getDayNameTextY(dayIndex - 1)\"\n          fill=\"#bbb\"\n          style=\"font: bold 20px sans-serif; text-transform: uppercase;\"\n        >\n          {{ getDayName(dayIndex) }}\n        </text>\n      </g>\n      <g\n        v-for=\"(dateNum, index) in numOfDays\"\n        :key=\"dateNum\"\n        class=\"monthly-heatmap__block\"\n        fill=\"transparent\">\n        <rect\n          :key=\"`rect:${index}`\"\n          :class=\"{\n            'monthly-heatmap__block__rect': true,\n            'is-loading': isLoading\n          }\"\n          :style=\"{\n            fill: getHeatColorByDateNum(dateNum),\n            animationDelay: `${randomizeDelay(index)}ms`\n          }\"\n          :width=\"rectSize\"\n          :height=\"rectSize\"\n          :rx=\"rectSize / 10\"\n          :ry=\"rectSize / 10\"\n          :x=\"getRectX(7 + index + startOfMonthOffsetInDays)\"\n          :y=\"getRectY(index + startOfMonthOffsetInDays)\" />\n        <title>\n          {{ getTooltipContentByDateNum(dateNum) }}\n        </title>\n      </g>\n    </svg>\n  </div>\n</template>\n\n<script>\nimport isValid from 'date-fns/isValid'\nimport formatDate from 'date-fns/format'\nimport getDaysInMonth from 'date-fns/getDaysInMonth'\nimport differenceInDays from 'date-fns/differenceInDays'\nimport startOfWeek from 'date-fns/startOfWeek'\nimport getWeeksInMonth from 'date-fns/getWeeksInMonth'\nimport isWeekend from 'date-fns/isWeekend'\nimport id from 'date-fns/locale/id'\n\nimport { formatDateShort } from '../../../lib/date'\nimport { mapGetters, mapState } from 'vuex'\n\nexport default {\n  inject: {\n    heatmapColorConfig: {\n      from: 'heatmapColorConfig',\n      default: () => []\n    }\n  },\n  props: {\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    month: {\n      type: Number\n    },\n    year: {\n      type: Number\n    }\n  },\n  data () {\n    return {\n      rectGap: 6,\n      rectSize: 60,\n      defaultColor: '#ECEFF1'\n    }\n  },\n  computed: {\n    isMonthAndYearDefined () {\n      const { month, year } = this\n      const isNumber = typeof month === 'number' && typeof year === 'number'\n      const isValidDate = isValid(new Date(year, month))\n      return isNumber && isValidDate\n    },\n    ...mapGetters('logbook-heatmap', [\n      'getTaskCountByDate'\n    ]),\n    ...mapState('logbook-heatmap', {\n      heatmapData (state) {\n        if (!this.isMonthAndYearDefined) {\n          return null\n        }\n        const key = `${parseInt(this.year)}/${parseInt(this.month)}`\n        return state.dataByMonthYear[key] || null\n      }\n    }),\n    startOfMonthOffsetInDays () {\n      if (!this.isMonthAndYearDefined) {\n        return 0\n      }\n      const monthStart = new Date(this.year, this.month, 1)\n      const calendarStart = startOfWeek(monthStart, {\n        weekStartsOn: 1\n      })\n      return differenceInDays(monthStart, calendarStart)\n    },\n    numOfWeeks () {\n      if (!this.isMonthAndYearDefined) {\n        return 0\n      }\n      return getWeeksInMonth(new Date(this.year, this.month))\n    },\n    numOfDays () {\n      if (!this.isMonthAndYearDefined) {\n        return 0\n      }\n      return getDaysInMonth(new Date(this.year, this.month))\n    },\n\n    viewBoxRectSize () {\n      // 7 is maximum num of weeks in month (6) + 1 column for day name\n      const maxNumOfColumns = 7\n      const width = (this.rectSize * maxNumOfColumns) + (this.rectGap * (maxNumOfColumns + 1))\n\n      // 7 is number of days within week\n      // 8 is number of gap for 7 rows\n      const height = (this.rectSize * 7) + (this.rectGap * 8)\n      return `0 0 ${width} ${height}`\n    },\n    monthName () {\n      return formatDate(new Date(this.year, this.month), 'MMMM', {\n        locale: id\n      })\n    }\n  },\n  methods: {\n    getDayName (dayIndex) {\n      // monday is zero in date-fns\n      const i = dayIndex === 7 ? 0 : dayIndex\n      return id.localize.day(i, {\n        width: 'short'\n      })\n    },\n    getDayNameTextY (dayIndex) {\n      const rectY = this.getRectY(dayIndex)\n      // 10 is half of font size\n      return 10 + rectY + Math.floor(this.rectSize / 2)\n    },\n    getDayNameTextX (dayIndex) {\n      return 0\n    },\n    getRectY (itemIndex) {\n      return this.rectGap + ((itemIndex % 7)) * (this.rectSize + this.rectGap)\n    },\n    getRectX (itemIndex) {\n      const colNum = Math.floor(itemIndex / 7)\n      return this.rectGap + (colNum * (this.rectSize + this.rectGap))\n    },\n\n    getTooltipContentByDateNum (dateNum) {\n      const dateObj = new Date(this.year, this.month, dateNum)\n      const dateString = formatDateShort(dateObj)\n\n      const taskCount = this.getTaskCountByDate(dateObj)\n      if (taskCount > 0) {\n        return `${taskCount} laporan pada ${dateString}`\n      }\n\n      if (isWeekend(dateObj)) {\n        return dateString\n      }\n      return `Belum ada laporan pada ${dateString}`\n    },\n    getHeatColorByDateNum (dateNum) {\n      if (this.isLoading) {\n        return this.defaultColor\n      }\n      const dateObj = new Date(this.year, this.month, dateNum)\n      const taskCount = this.getTaskCountByDate(dateObj)\n      const color = this.getColorByTaskCount(taskCount)\n      return color\n    },\n    getColorByTaskCount (count) {\n      const { heatmapColorConfig } = this\n      if (!Array.isArray(heatmapColorConfig) || !heatmapColorConfig.length) {\n        return this.defaultColor\n      }\n\n      let color\n      for (let i = 0, len = heatmapColorConfig.length; i < len; i++) {\n        const minTask = heatmapColorConfig[i][0]\n        const maxTask = i < len - 1\n          ? heatmapColorConfig[i + 1][0]\n          : Number.MAX_SAFE_INTEGER\n\n        if (count >= minTask && count < maxTask) {\n          color = heatmapColorConfig[i][1]\n          break\n        }\n      }\n      return color || this.defaultColor\n    },\n    randomizeDelay () {\n      return (Math.random() ** 4) * 5000\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@keyframes rotatingRect {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n.monthly-heatmap {\n  max-width: 200px;\n  @apply inline-flex flex-col justify-between items-stretch;\n\n  &__blocks {\n    display: inline;\n    @apply w-full;\n  }\n\n  &__block {\n    transform-origin: 0 0;\n    @apply border-none bg-transparent;\n\n    &__rect {\n      transform-origin: center;\n      transform-box: fill-box;\n      cursor: pointer;\n      @apply border-none stroke-0;\n\n      &:hover {\n        stroke: rgb(0, 0, 0, 0.2);\n        stroke-width: 6;\n      }\n\n      &.is-loading {\n        animation: rotatingRect 1s infinite alternate ease-out;\n      }\n    }\n  }\n\n  &__month-name {\n    @apply block mb-2\n    text-left text-sm\n    text-green-600 font-bold;\n  }\n}\n</style>\n"]}]}