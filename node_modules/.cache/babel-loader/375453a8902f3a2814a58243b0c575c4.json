{"remainingRequest":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/babel-loader/lib/index.js!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/eslint-loader/index.js??ref--14-0!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/store/modules/logbook-documents.js","dependencies":[{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/store/modules/logbook-documents.js","mtime":1673491775271},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/babel-loader/lib/index.js","mtime":1673491971758},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/eslint-loader/index.js","mtime":1673491969842}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvamRzL0RvY3VtZW50cy9kaXNrb21pbmZvL2pkcy9kaWdpdGVhbS9ncm91cHdhcmUvZ3JvdXB3YXJlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgeyBHcm91cHdhcmVBUEkgfSBmcm9tICcuLi8uLi9saWIvYXhpb3MnOwpleHBvcnQgdmFyIHN0YXRlID0gZnVuY3Rpb24gc3RhdGUoKSB7CiAgcmV0dXJuIHsKICAgIGRvY3VtZW50czoge30KICB9Owp9OwpleHBvcnQgdmFyIG11dGF0aW9ucyA9IHsKICBrZWVwRG9jdW1lbnRJbkNhY2hlOiBmdW5jdGlvbiBrZWVwRG9jdW1lbnRJbkNhY2hlKHN0YXRlLCBfcmVmKSB7CiAgICB2YXIgaWQgPSBfcmVmLmlkLAogICAgICAgIGZpbGUgPSBfcmVmLmZpbGU7CgogICAgaWYgKHR5cGVvZiBpZCA9PT0gJ3N0cmluZycgJiYgaWQubGVuZ3RoICYmIGZpbGUgaW5zdGFuY2VvZiBGaWxlKSB7CiAgICAgIFZ1ZS5zZXQoc3RhdGUuZG9jdW1lbnRzLCBpZCwgZmlsZSk7CiAgICB9CiAgfQp9OwpleHBvcnQgdmFyIGFjdGlvbnMgPSB7CiAgZ2V0RG9jdW1lbnQ6IGZ1bmN0aW9uIGdldERvY3VtZW50KF9yZWYyKSB7CiAgICB2YXIgX2FyZ3VtZW50cyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBzdGF0ZSwgY29tbWl0LCBfcmVmMywgcGF0aCwgX3JlZjMkY2FjaGVGaXJzdCwgY2FjaGVGaXJzdCwgYmxvYiwgZmlsZW5hbWUsIGZpbGU7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc3RhdGUgPSBfcmVmMi5zdGF0ZSwgY29tbWl0ID0gX3JlZjIuY29tbWl0OwogICAgICAgICAgICAgIF9yZWYzID0gX2FyZ3VtZW50cy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHNbMV0gOiB7fSwgcGF0aCA9IF9yZWYzLnBhdGgsIF9yZWYzJGNhY2hlRmlyc3QgPSBfcmVmMy5jYWNoZUZpcnN0LCBjYWNoZUZpcnN0ID0gX3JlZjMkY2FjaGVGaXJzdCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWYzJGNhY2hlRmlyc3Q7CgogICAgICAgICAgICAgIGlmICghKHR5cGVvZiBwYXRoICE9PSAnc3RyaW5nJyB8fCAhcGF0aC5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdwYXRoIGlzIGVpdGhlciBlbXB0eSBvciBub3QgYSBzdHJpbmcnKSkpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGlmICghKHBhdGggaW4gc3RhdGUuZG9jdW1lbnRzID09PSBmYWxzZSB8fCBjYWNoZUZpcnN0ID09PSBmYWxzZSkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIEdyb3Vwd2FyZUFQSS5nZXQoImZpbGUvIi5jb25jYXQocGF0aCksIHsKICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogJ2Jsb2InCiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgcmV0dXJuIHIuZGF0YTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBibG9iID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBmaWxlbmFtZSA9IHBhdGgucmVwbGFjZSgnZG9jdW1lbnQvJywgJycpOwogICAgICAgICAgICAgIGZpbGUgPSBuZXcgRmlsZShbYmxvYl0sIGZpbGVuYW1lKTsKICAgICAgICAgICAgICBjb21taXQoJ2tlZXBEb2N1bWVudEluQ2FjaGUnLCB7CiAgICAgICAgICAgICAgICBpZDogcGF0aCwKICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgc3RhdGUuZG9jdW1lbnRzW3BhdGhdKTsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKCk7CiAgfQp9Ow=="},{"version":3,"sources":["/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/store/modules/logbook-documents.js"],"names":["Vue","GroupwareAPI","state","documents","mutations","keepDocumentInCache","id","file","length","File","set","actions","getDocument","commit","path","cacheFirst","Promise","reject","Error","get","responseType","then","r","data","blob","filename","replace"],"mappings":";;;;;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,SAASC,YAAT,QAA6B,iBAA7B;AAEA,OAAO,IAAMC,KAAK,GAAG,SAARA,KAAQ;AAAA,SAAO;AAC1BC,IAAAA,SAAS,EAAE;AADe,GAAP;AAAA,CAAd;AAIP,OAAO,IAAMC,SAAS,GAAG;AACvBC,EAAAA,mBADuB,+BACFH,KADE,QACmB;AAAA,QAAZI,EAAY,QAAZA,EAAY;AAAA,QAARC,IAAQ,QAARA,IAAQ;;AACxC,QAAI,OAAOD,EAAP,KAAc,QAAd,IAA0BA,EAAE,CAACE,MAA7B,IAAuCD,IAAI,YAAYE,IAA3D,EAAiE;AAC/DT,MAAAA,GAAG,CAACU,GAAJ,CAAQR,KAAK,CAACC,SAAd,EAAyBG,EAAzB,EAA6BC,IAA7B;AACD;AACF;AALsB,CAAlB;AAQP,OAAO,IAAMI,OAAO,GAAG;AACfC,EAAAA,WADe,8BACmD;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAnDV,cAAAA,KAAmD,SAAnDA,KAAmD,EAA5CW,MAA4C,SAA5CA,MAA4C;AAAA,6FAAJ,EAAI,EAAhCC,IAAgC,SAAhCA,IAAgC,2BAA1BC,UAA0B,EAA1BA,UAA0B,iCAAb,IAAa;;AAAA,oBAClE,OAAOD,IAAP,KAAgB,QAAhB,IAA4B,CAACA,IAAI,CAACN,MADgC;AAAA;AAAA;AAAA;;AAAA,+CAE7DQ,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,sCAAV,CAAf,CAF6D;;AAAA;AAAA,oBAIlEJ,IAAI,IAAIZ,KAAK,CAACC,SAAd,KAA4B,KAA5B,IAAqCY,UAAU,KAAK,KAJc;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAKjDd,YAAY,CAACkB,GAAb,gBAAyBL,IAAzB,GAAiC;AAClDM,gBAAAA,YAAY,EAAE;AADoC,eAAjC,EAEhBC,IAFgB,CAEX,UAAAC,CAAC;AAAA,uBAAIA,CAAC,CAACC,IAAN;AAAA,eAFU,CALiD;;AAAA;AAK9DC,cAAAA,IAL8D;AAQ9DC,cAAAA,QAR8D,GAQnDX,IAAI,CAACY,OAAL,CAAa,WAAb,EAA0B,EAA1B,CARmD;AAS9DnB,cAAAA,IAT8D,GASvD,IAAIE,IAAJ,CAAS,CAACe,IAAD,CAAT,EAAiBC,QAAjB,CATuD;AAUpEZ,cAAAA,MAAM,CAAC,qBAAD,EAAwB;AAC5BP,gBAAAA,EAAE,EAAEQ,IADwB;AAE5BP,gBAAAA,IAAI,EAAEA;AAFsB,eAAxB,CAAN;;AAVoE;AAAA,+CAe/DL,KAAK,CAACC,SAAN,CAAgBW,IAAhB,CAf+D;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBvE;AAjBoB,CAAhB","sourcesContent":["import Vue from 'vue'\nimport { GroupwareAPI } from '../../lib/axios'\n\nexport const state = () => ({\n  documents: {}\n})\n\nexport const mutations = {\n  keepDocumentInCache (state, { id, file }) {\n    if (typeof id === 'string' && id.length && file instanceof File) {\n      Vue.set(state.documents, id, file)\n    }\n  }\n}\n\nexport const actions = {\n  async getDocument ({ state, commit }, { path, cacheFirst = true } = {}) {\n    if (typeof path !== 'string' || !path.length) {\n      return Promise.reject(new Error('path is either empty or not a string'))\n    }\n    if (path in state.documents === false || cacheFirst === false) {\n      const blob = await GroupwareAPI.get(`file/${path}`, {\n        responseType: 'blob'\n      }).then(r => r.data)\n      const filename = path.replace('document/', '')\n      const file = new File([blob], filename)\n      commit('keepDocumentInCache', {\n        id: path,\n        file: file\n      })\n    }\n    return state.documents[path]\n  }\n}\n"]}]}