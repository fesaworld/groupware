{"remainingRequest":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/babel-loader/lib/index.js!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/eslint-loader/index.js??ref--14-0!/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/lib/fcm-notification.js","dependencies":[{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/lib/fcm-notification.js","mtime":1673491775269},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/cache-loader/dist/cjs.js","mtime":1673491971474},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/babel-loader/lib/index.js","mtime":1673491971758},{"path":"/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/node_modules/eslint-loader/index.js","mtime":1673491969842}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgbWVzc2FnaW5nIH0gZnJvbSAnLi9maXJlYmFzZSc7CmltcG9ydCBzdG9yZSBmcm9tICcuLi9zdG9yZSc7CmV4cG9ydCBmdW5jdGlvbiBnZXREZXZpY2VUb2tlbkJ5VXNlcklkKHVzZXJJZCkgewogIHJldHVybiBzdG9yZS5kaXNwYXRjaCgnZmNtL2dldERldmljZVRva2VuQnlVc2VySWQnLCB7CiAgICB1c2VySWQ6IHVzZXJJZAogIH0pOwp9CgpmdW5jdGlvbiBvblRva2VuUmV0cmlldmVkKHRva2VuKSB7CiAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCdmY20vY3JlYXRlUmVnaXN0cmF0aW9uVG9rZW4nLCB7CiAgICB0b2tlbjogdG9rZW4KICB9KTsKfQoKZnVuY3Rpb24gb25Ub2tlblJlZnJlc2hlZCh0b2tlbikgewogIHJldHVybiBzdG9yZS5kaXNwYXRjaCgnZmNtL3VwZGF0ZVJlZ2lzdHJhdGlvblRva2VuJywgewogICAgdG9rZW46IHRva2VuCiAgfSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiByZXRyaWV2ZVRva2VuKCkgewogIGlmICghbWVzc2FnaW5nKSByZXR1cm47CiAgbWVzc2FnaW5nLmdldFRva2VuKCkudGhlbihmdW5jdGlvbiAoY3VycmVudFRva2VuKSB7CiAgICBpZiAoY3VycmVudFRva2VuKSB7CiAgICAgIG9uVG9rZW5SZXRyaWV2ZWQoY3VycmVudFRva2VuKTsKICAgIH0KICB9KTsKfQpleHBvcnQgZnVuY3Rpb24gdXBkYXRlVG9rZW4oKSB7CiAgaWYgKCFtZXNzYWdpbmcpIHJldHVybjsKICBtZXNzYWdpbmcuZ2V0VG9rZW4oKS50aGVuKGZ1bmN0aW9uIChjdXJyZW50VG9rZW4pIHsKICAgIGlmIChjdXJyZW50VG9rZW4pIHsKICAgICAgb25Ub2tlblJlZnJlc2hlZChjdXJyZW50VG9rZW4pOwogICAgfQogIH0pOwp9CmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5Ub1JlZnJlc2hUb2tlbkV2ZW50KCkgewogIGlmICghbWVzc2FnaW5nKSByZXR1cm47CiAgbWVzc2FnaW5nLm9uVG9rZW5SZWZyZXNoKGZ1bmN0aW9uICgpIHsKICAgIG1lc3NhZ2luZy5nZXRUb2tlbigpLnRoZW4oZnVuY3Rpb24gKHJlZnJlc2hlZFRva2VuKSB7CiAgICAgIG9uVG9rZW5SZWZyZXNoZWQocmVmcmVzaGVkVG9rZW4pOwogICAgfSk7CiAgfSk7Cn0="},{"version":3,"sources":["/Users/jds/Documents/diskominfo/jds/digiteam/groupware/groupware/src/lib/fcm-notification.js"],"names":["messaging","store","getDeviceTokenByUserId","userId","dispatch","onTokenRetrieved","token","onTokenRefreshed","retrieveToken","getToken","then","currentToken","updateToken","listenToRefreshTokenEvent","onTokenRefresh","refreshedToken"],"mappings":"AAAA,SAASA,SAAT,QAA0B,YAA1B;AACA,OAAOC,KAAP,MAAkB,UAAlB;AAEA,OAAO,SAASC,sBAAT,CAAiCC,MAAjC,EAAyC;AAC9C,SAAOF,KAAK,CAACG,QAAN,CAAe,4BAAf,EAA6C;AAAED,IAAAA,MAAM,EAANA;AAAF,GAA7C,CAAP;AACD;;AAED,SAASE,gBAAT,CAA2BC,KAA3B,EAAkC;AAChC,SAAOL,KAAK,CAACG,QAAN,CAAe,6BAAf,EAA8C;AAAEE,IAAAA,KAAK,EAALA;AAAF,GAA9C,CAAP;AACD;;AAED,SAASC,gBAAT,CAA2BD,KAA3B,EAAkC;AAChC,SAAOL,KAAK,CAACG,QAAN,CAAe,6BAAf,EAA8C;AAAEE,IAAAA,KAAK,EAALA;AAAF,GAA9C,CAAP;AACD;;AAED,OAAO,SAASE,aAAT,GAA0B;AAC/B,MAAI,CAACR,SAAL,EAAgB;AAChBA,EAAAA,SAAS,CAACS,QAAV,GAAqBC,IAArB,CAA0B,UAACC,YAAD,EAAkB;AAC1C,QAAIA,YAAJ,EAAkB;AAChBN,MAAAA,gBAAgB,CAACM,YAAD,CAAhB;AACD;AACF,GAJD;AAKD;AAED,OAAO,SAASC,WAAT,GAAwB;AAC7B,MAAI,CAACZ,SAAL,EAAgB;AAChBA,EAAAA,SAAS,CAACS,QAAV,GAAqBC,IAArB,CAA0B,UAACC,YAAD,EAAkB;AAC1C,QAAIA,YAAJ,EAAkB;AAChBJ,MAAAA,gBAAgB,CAACI,YAAD,CAAhB;AACD;AACF,GAJD;AAKD;AAED,OAAO,SAASE,yBAAT,GAAsC;AAC3C,MAAI,CAACb,SAAL,EAAgB;AAChBA,EAAAA,SAAS,CAACc,cAAV,CAAyB,YAAM;AAC7Bd,IAAAA,SAAS,CAACS,QAAV,GAAqBC,IAArB,CAA0B,UAACK,cAAD,EAAoB;AAC5CR,MAAAA,gBAAgB,CAACQ,cAAD,CAAhB;AACD,KAFD;AAGD,GAJD;AAKD","sourcesContent":["import { messaging } from './firebase'\nimport store from '../store'\n\nexport function getDeviceTokenByUserId (userId) {\n  return store.dispatch('fcm/getDeviceTokenByUserId', { userId })\n}\n\nfunction onTokenRetrieved (token) {\n  return store.dispatch('fcm/createRegistrationToken', { token })\n}\n\nfunction onTokenRefreshed (token) {\n  return store.dispatch('fcm/updateRegistrationToken', { token })\n}\n\nexport function retrieveToken () {\n  if (!messaging) return\n  messaging.getToken().then((currentToken) => {\n    if (currentToken) {\n      onTokenRetrieved(currentToken)\n    }\n  })\n}\n\nexport function updateToken () {\n  if (!messaging) return\n  messaging.getToken().then((currentToken) => {\n    if (currentToken) {\n      onTokenRefreshed(currentToken)\n    }\n  })\n}\n\nexport function listenToRefreshTokenEvent () {\n  if (!messaging) return\n  messaging.onTokenRefresh(() => {\n    messaging.getToken().then((refreshedToken) => {\n      onTokenRefreshed(refreshedToken)\n    })\n  })\n}\n"]}]}